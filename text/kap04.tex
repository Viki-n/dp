\chapter{Výsledky}

V této kapitole popíšeme chování naší implementace stromů na několika třídách přístupových posloupností.

\section{Náhodná přístupová posloupnost}

Třída náhodných přístupových posloupností vypadá tak, že pro danou velikost
strom vyrobíme náhodnou posloupnost přirozených čísel z intervalu $[0,n)$.
Náhodná čísla generujeme pomocí pseudonáhodného generátoru {\tt xoshiro256++},
který představili \citet{xoshiro}. Pro měření jsme zvolili velikosti stromů od $10$ do $1\cdot
10^8$, kde každá další testovaná velikost byla $\sqrt[7]{10}$-krát větší, než ta předchozí. Takovýto krok
jsme zvolili proto, že s ním v celém rozsahu měříme celkem 50 různých velikostí
stromu, tedy dosáhneme rozumného kompromisu mez počtem vzorků a celkovou
dobou měření. 

Délka posloupnosti byla vždy $\max(1\cdot10^7, 10\cdot n)$.
Takové číslo jsme zvolili proto, abychom snížili pravděpodobnost, že dostaneme
náhodnou posloupnost, jejíž čas běhu a počet dotyků na operaci budou daleko od
příslušné střední hodnoty, abychom i pro větší $n$ alespoň jednou navštívili
téměř všechny prvky a aby
nepřesnost měření času (která může dosahovat až řádově desítek milisekund)
nehrála významnou roli v celkovém času vykonávání posloupnosti. 

\def\graphfigure#1#2{
\begin{figure}[h!]
\centering
 \makebox[\textwidth][c]{\includegraphics{graphs/#1}}
\caption{#2}
\label{obr:#1}
\end{figure}
}

\graphfigure{touch_r}{Doteky vrcholů -- náhodná přístupová posloupnost.}


Při vlastním měření jsme ale neměřili dvě nejvyšší hodnoty $n$ pro tango strom kvůli vysoké časové náročnosti měření.

Na základě teorie bychom čekali, že počet doteků na operaci u multisplay, splay a červenočerného stromu poroste logaritmicky s počtem vrcholů, u tango stromu ještě s faktorem $\log\log$ navíc, což měření potvrzují, viz obrázek \ref{obr:touch_r}.
\let\oldlog\log
\def\log{\oldlog_2}

Na grafu vidíme, že červenočerný strom potřebuje konzistentně přibližně $(\log
n) - 1/2$. $\log n$ jsme do grafu přidali pro porovnání. To zní podezřele --
pro červenočerný strom je střední hodnota počtu doteků na operaci z náhodné
přístupové posloupnosti prostě průměrná hloubka vrcholu (kde kořen má hloubku
1). Dokonale vyvážený strom na $n$ vrcholech má průměrnou hloubku vrcholu
vrcholu $(\log n) - 1 + o(1)$. My jsme ale v minulé kapitole řekli, že náš
červenočerný strom je tak nevyvážený, jak je jen možné.

Jak je tedy možné, že průměrná hloubka vrcholu ve velmi nevyváženém
červenočerném stromu je jen o aditivní $1/2$ větší než v dokonale vyváženém
stromu? Odpověď na tuto otázku je v nejasné definici velmi nevyváženého stromu.
Náš strom vypadá tak, že na cestě z kořene do maxima se střídají černé a červené
vrcholy, ale celý zbytek stromu krom této cesty a vrcholů s ní bezprostředně
sousedících je stále černý. Proto je i vyvážený, jak to jen jde -- kvůli
invariantu červenočerného stromu je každý čistě černý podstrom dokonale
vyvážený.

Náš strom je
tedy extrémně nevyvážený v tom smyslu, že dosahuje co nejvyšší možné maximální
hloubky při daném počtu vrcholů. Také je extrémně nevyvážený stran poměru
velikosti pravého a levého podstromu kořene (v závislosti na přesné velikosti
experimentálně určeného jako $2:5$ až $1:5$). Protože však současně jsou
podstromy všech vrcholů krom těch ležících na cestě z kořene do maxima dokonale
vyvážené, stran průměrné hloubky vrcholu je takto vybudovaný strom poměrně
blízko dokonale vyváženému stromu.


Splay strom potom potřebuje zhruba $1.28\cdot \log n$ doteku na přístup, multisplay strom
dokonce $3.35\cdot \log n$. U tango stromu jsme na našem vzorku naměřili v
průměru $4.88\cdot \log n$ doteků, což ale není příliš zajímavé -- u ostatních
stromů očekáváme, že bude počet doteků na operaci dělený logaritmem velikosti stromu konvergovat
k nějaké konstantě, u tango stromu toto očekávání nemáme. Nejvyšší zaznamenaný
počet dotyků pro tango strom byl v testu pro $n \cong 5.18\cdot 10^7$. V tomto
testu jsme naměřili asi $6.81\cdot \log n$ doteků na operaci. Pro srovnání,
$\log\log 5.18\cdot 10^7 \cong 4.68$. 

Dále si všimneme mírného rozvlnění křivky tango stromu kolem $n=5\cdot 10^3$ a
znovu kolem $n=1\cdot 10^6$. Tento efekt se ale výrazněji projeví při
sekvenčních přstupech, které budeme diskutovat v následující sekci, s jeho
vysvětlením tedy počkáme tam.

\graphfigure{time_r}{Průměrný čas na operaci -- náhodná přístupová posloupnost.}

Na obrázku \ref{obr:time_r} vidíme naměřené časy. Proti obrázku \ref{obr:touch_r}
se křivka tango stromu ještě trochu vzdálila ostatním. Dále vidíme zlom všech
křivek pro $n$ mezi $1\cdot10^6$ a $1\cdot 10^7$. Vzhledem k tomu, že použitý
procesor má $128\,\operatorname{MB}$ L3 cache a jeden vrchol  červenočerného či
splay stromu zabírá v paměti 24 bytů, přibližně při $3\cdot 10^6$ vrcholech se již
strom nevejde do cache současně s $40\,\operatorname{MB}$, které zabírá načtená
část přístupové posloupnosti. Přibližně při $5\cdot10^6$ vrcholech se pak již strom nevejde do cache ani sám.
Jeden vrchol multisplay stromu a tango stromu pak zabírá 32 bytů a výše uvedené pro ně platí obdobně. 

\graphfigure{ratio_r}{Průměrný čas na dotyk -- náhodná přístupová posloupnost.}

Překvapivé je, že kolem $n=2\cdot10^6$ se splay strom stává rychlejší než
červenočerný strom. Ve skutečnosti se podle grafu na obrázku \ref{obr:ratio_r}
průměrný čas na dotek vrcholu v červenočerném stromu propadá až téměř na úroveň tango
stromu -- to je obzvláště překvapivé proto, že červenočerný strom vrcholy pouze
prochází a nijak strom nemodifikuje, kdežto všechny ostatní stromy vrcholy
modifikují a navíc jimi mohou projít během jedné operace i vícekrát, což my
ovšem ale stále počítáme jako jeden dotyk.

Toto chování má své vysvětlení, předtím, než k němu přistoupíme ale musíme udělat krátkou odbočku, v níž vysvětlíme, jak funguje cache procesoru.

\subsection{Červenočerný strom a cache}

Procesor má obvykle tři úrovně cache, nejmenší L1, o něco větší L2 a největší
L3. To pro nás ale teď nebude důležité -- omezíme se pouze na jednu úroveň.
Cache je rozdělená na jednotlivé řádky, v dnešních procesorech typicky 64 bytů
velké. Pokud procesor chce přistoupit na nějakou adresu, blok paměti o
velikosti jednoho cachového řádku zarovnaný na velikost cachového
řádku\footnote{To znamená, že adresa začátku tohoto bloku je dělitelná délkou
cachového řádku.} obsahující tuto adresu je načten do cache. Může se ale stát,
že v cachi už není volné místo. V ideálním světě by v takovém případě cache
vybrala z řádků, které obsahuje, ten, ke kterému procesor nejdéle nepřistoupil,
a ten by odstranila. Tomuto přístupu obecně říkáme \emph{LRU\footnote{Z
anglického \emph{least recently used}.} cache}.

Pro to bychom ale potřebovali, aby libovolný řádek cache mohl obsahovat
libovolný blok paměti. Takovou cache bychom nazvali \emph{plně asociativní}.
Potom by ale bylo velmi obtížné zjistit, kde v cachi je daný blok paměti
uložený. Proto jsou v praxi cache \emph{$k$-cestně asociativní}. To znamená, že
každý blok může být uložen pouze na $k$ různých místech v cachi. Která místa to
budou je pak určeno několika nejnižšími bity adresy bloku. Konkrétně pokud máme
cache o $C$ bytech, uložení bloku určuje $\log (C/k)$ nejnižších bitů jeho
adresy.

To znamená, že pokud jsou dva bloky paměti uložené na adresách, které dávají
stejný zbytek po dělení dostatečně velkou mocninou dvojky, mají oba na výběr
pouze $k$ míst v cachi, kam mohou být uloženy. Navíc se jedná o těch samých $k$
míst. Tomu říkáme, že tyto bloky, případně adresy, \emph{aliasují}.

Kdybychom potřebovali pracovat s větším počtem aliasujících bloků, přestává být
podstatný celkový počet řádků, které se do cache vejdou -- o tom, jak úspěšná
cache bude, rozhoduje pouze hdnota $k$.

Nyní se vrátíme k červenočerným stromům. Již dříve jsme řekli, že náš postup stavby červenočerného stromu vede k tomu, že podstrom každého vrcholu krom vrcholů na cestě z kořene k maximu je dokonale vyvážený. Proto můžeme pro zjednodušení problém vysvětlit na dokonale vyváženém stromu. Pro strom, který dostaneme z naší konstrukce červenočerného stromu budou závěry, které uděláme, platit podobně. Jediná důležitá věc, které si ještě musíme všimnout, je, že náš způsob alokace paměti spolu s naším způsobem stavby stromu vede k tomu, že vrcholy jsou v paměti uloženy jeden za druhým v rostoucím pořadí.

Mějme tedy dokonale vyvážený strom nad množinou klíčů $[2^k-1]$. Všimneme si že v listech jsou uložena právě lichá čísla. V jejich rodičích jsou uložena právě čísla, která dávají zbytek 2 po dělení 4. V jejich rodičích pak čísla, která dávají zbytek 4 po dělení 8. Takto bychom mohli pokračovat dál až k tomu, že v kořeni je právě číslo, které dává zbytek $2^{k-1}$ při dělení $2^k$ (mimo jiné proto, že v kořeni je přesně číslo $2^{k-1}$).

Na to se můžeme ale podívat i opačně, shora dolů. Nahlédneme, že v kořeni je právě číslo dělitelné $2^{k-1}$. V kořeni a jeho synech jsou pak dohromady právě všechna čísla dělitelná $2^{k-2}$. Podobně můžeme pokračovat dál -- všimneme si, že v prvních $h$ hladinách jsou uložena právě všechna čísle, která jsou dělitelná $2^{k-h}$. A jsou-li tedy vrcholy uložené za sebou v rostoucím pořadí jejich klíčů, a navíc předpokládáme, že množství bytů v paměti, které jeden vrchol zabírá, je dělitelné 8 (tento předpoklad splňují všechny naše implementace stromů), potom adresy všech vrcholů z prvních $h$ hladin dávají po dělení $2^{k-h+3}$ stejný zbytek.

Nyní se zamyslíme, jaké chování cache bychom si přáli při vykonávání náhodné přístupové posloupnosti nad dokonale vyváženým binárním vyhledávacím stromem. Pravděpodobnost návštěvy vrcholu $v$ při daném přístupu je přesně rovna velikosti jeho podstromu dělené počtem vrcholu ve stromu. To znamená, že tato pravděpodobnost je klesající funkce hloubky tohoto vrcholu. My bychom si přáli držet si v cachi (samozřejmě za podmínky, že máme příliš malou cache, než aby se nám do ní vešel celý strom) právě vrcholy, které mají pravděpodobnost přístupu alespoň $p$ pro vhodně zvolené $p$. Rozmyslíme si, že (opět pro dostatečně velký strom) není možné, že bychom do jednoho řádku cache uložili více zajímavých vrcholů (například v našem případě -- vrcholy stromu jsou 24 bytové, řádky cache 64 bytové. I kdybychom do jednoho řádku uložili 3 vrcholy, oba sousedi libovolného vrcholu $v$ s nízkou hloubkou jsou listy, a jejich sousedé různí od $v$ jsou jejich rodiče). Proto prostě chceme do cache uložit prvních $h$ hladin stromu pro vhodně zvolené $h$.

Jak jsme ale již ukázali, pokud má strom celkem $\ell$ hladin, prvních $h$
hladin obsahuje vrcholy, jejichž adresy jsou kongruentní modulo $2^{\ell - h}$.
Pokud naše cache má kapacitu $2^c$ bytů a je $k$-asociativní, budou tyto adresy
rozděleny pouze do $\max\left(1, 2^{c+h-\ell - 3}/k\right)$ tříd
ekvivalence aliasování, a současně jich tedy bude moct být uloženo nejvýše
$\max\left(k, 2^{c+h-\ell - 3}\right).$

Pokud do tohoto vzorce dosadíme náš hardware a náš největší měřený případ,
dostaneme dostaneme následující informace: Naše L3 cache má $128
\,\operatorname{MB}$. Jeden cachový řádek má 64 bytů. Naše cache má tedy
$2^{27}$ bytů a $2^{21}$ řádků Proto bychom do ní rádi uložili prvních 21 hladin stromu. Náš
největší měřený případ měl $1\cdot 10^8 > 2 ^ {26}$ vrcholů. Z těchto ale můžeme současně uložit jen $2^{27 + 21 - 26 - 3} = 2^{19}$, tedy jednu čtvrtinu toho, co bychom mohli s plně asociativní cachí. V tomto výpočtu jsme navíc zanedbali další faktory, které nám mohou škodit -- do cache se musí vejít i jiné věci, než prvních $h$ hladin stromu, jako třeba náš program, naše poslední cesty stromem mimo prvních $h$ hladin, nebo aktuální kus přístupové posloupnosti. Dále je potřeba si uvědomit, že podobný problém nastane na všech úrovních cache současně.

Tím bychom tedy měli vyřešené chování dokonale vyváženého stromu a můžeme se vrátit k červenočernému stromu.

\section{Sekvenční přístupová posloupnost}

V této třídě zvolíme velikosti stromů i délky posloupností stejně jako v třídě
náhodných přístupových posloupností, ale místo náhodných dat budeme stále kolem
dokola přistupovat postupně ke všem vrcholům ve stromu v rostoucím pořadí.

Na základě teorie bychom čekali, že počet dotyků na operaci splay a multisplay
stromu bude v $n$ konstantní. Pro tango strom očekáváme $\Theta(\oldlog\oldlog
n)$ doteků na operaci. Vzhledem k tomu, že pro červenočerný strom byla tato
posloupnost implementována (stejně jako u ostatních stromů) jako posloupnost
individuálních operací \ope{Find}, očekáváme stejné chování jako u náhodné
přístupové posloupnosti, přestože v libovolném statickém stromě obecně lze
implementovat průchod v rostoucím pořadí v čase $\Theta(n)$.

\graphfigure{touch_s}{Doteky vrcholů -- sekvenční přístupová posloupnost.}

Tyto předpoklady víceméně naplňuje graf na obrázku \ref{obr:touch_s}. Vidíme,
že splay strom se ustálil kolem $5.42$ dotyků na operaci, multisplay strom
kolem $8.49$ s větším rozptylem, kdežto počet dotyků tango stromu a
červenočerného stromu napříč celým grafem stále roste. Počínaje $n\cong 1000$
se červenočerný strom dotkne nejvíce vrcholů ze všech (přesnou hodnotu nelze
určit kvůli velkému rozptylu tango stromu). Nejlepšího výsledku doshuje pro
stromy o 26 prvcích a menší červenočerný strom, počínaje $n=37$ se nejméně
vrcholů dotkne splay strom. I počet dotyků multisplay stromu má určitý rozptyl,
proto nelze přesně určit, pro jakou hodnotu $n$ začne mít tango strom méně
dotyků na operaci než červenočerný strom, nicméně pro $n$ mezi $1000$ a $2500$
vychází počet dotyků oběma stromům podobně, pro vyšší hodnoty má tango strom
méně dotyků.

\graphfigure{time_s}{Průměrný čas na operaci -- sekvenční přístupová posloupnost.}

Budeme-li se však koukat na čas běhu, který je zachycený v obrázku
\ref{obr:time_s}, zjistíme, že pro $n<100$ je v praxi nejrychlejší červenočerný
strom. To jednoduše zdůvodníme tím, že červenočerný strom při každém přístupu
každý dotčený vrchol skutečně bez modifikací navštíví. Splay strom oproti tomu
navštívenými vrcholy prochází dvakrát (jednou při hledání, jednou při cestě
zpět ke kořeni), přičemž při cestě zpět ke kořeni navíc navštívené vrcholy
modifikuje.  Pro vyšší hodnoty $n$ je ale konzistentních
$40\,\operatorname{ns}$ na operaci, kterých dosahuje splay strom, výhodnější.


Multisplay strom může jedním vrcholem projít i vícekrát a dokonce
ho i vícekrát modifikovat (první modifikaci vrcholu provede při změnách
prefervaných cest tak aby byl hledaný vrchol v pomocném stromě s kořenem,
druhou poté při závěrečné změně preferovaného syna hledaného vrcholu). Proto
také potřebuje přibližně $250\,\operatorname{ns}$ na operaci a rychlejší než
červenočerný strom je až pro $n>1\cdot 10^7$. Tango strom má v jistém smyslu
současně všechny nevýhody červenočerného stromu a multisplay stromu -- stejně
jako červenočerný strom neslibuje asymptoticky konstantní čas na operaci (byť
jeho asymptotická složitost je lepší než složitost červenočerného stromu),
stejně jako multisplay strom může vrcholy při přepojování preferovaných cest i
opakovaně modifikovat. Proto není divu, že i pro největší měřená data je
dvojnásobně až trojnásobně pomalejší než červenočerný strom.

Nyní se konečně dostáváme k nejpřekvapivějšímu z naměřených jevů. Musíme
vysvětlit, proč to vypadá, že má tango strom a v menší míře multisplay strom
výrazný rozptyl, a proč se tento rozptyl neprojevuje pro $n\cong 1\cdot 10^4$ a
$n\cong 5\cdot10^6$. Pro osvětlení této otázky jsme provedli ještě jedno
měření. Opět jsme měřili počet dotyků na operaci pro sekvenční přístupovou
posloupnost, ale zvolili jsme $m=2n$, a navíc jsem doteky počítali pouze během
druhého průchodu. Na druhou stranu jsme měřili všechna možná $n$ z intervalu
$[10, 1\cdot10^4]$. Výsledky měření jsou vidět na obrázku
\ref{obr:one_by_one_seq}.

\graphfigure{one_by_one_seq}{Doteky vrcholů -- sekvenční přístupová posloupnost.}

Lokální maxima křivky tango i multisplay stromu jsou v hodnotách ve tvaru $2^k \pm \o(1)$ pro nějaké $k$, minima v $3\cdot 2^k\pm \o(1)$ pro nějaké $k$. 

Abychom toto chování vysvětlili, musíme si rozmyslet, jak přesně probíhá
sekvenční přístup v tango stromu. Na konci prvního sekvenčního průchodu mají
všechny vrcholy nastavený preferovaný směr doprava. My musíme během průchodu
nastavit každému vrcholu preferovaný směr nejprve doleva, a poté zase zpět
doprava. Tedy každému vrcholu jeho preferovaný směr změníme celkem dvakrát.

Je ale důležité si uvědomit, že v tango stromu se změny preferovaných směrů
týkají pouze vrcholů, které mají v referenčním stromě $P$ oba syny. My v naší
implementaci však stavíme $P$ tak, aby se pro každý jeho vrchol $v$ lišila
velikost pravého a levého podstromu vrcholu $v$ nejvýše o jedna. To vede k tomu, že pokud se
$n$ rovná $3\cdot2^k-1$ pro nějaké $k$, $P$ vypadá tak, že na jeho předposlední
hladině mají všechny vrcholy právě jednoho syna, a tedy v nich nelze změny
preferovaných směrů provádět. Proto pro každé $k$ platí, že při sekvenčním
průchodu stromem libovolné velikosti mezi $2^k-1$ a $3\cdot 2^{k-1}-1$ je vždy
potřeba udělat přesně ten samý počet změn preferovaných směrů. Těchto změn je přesně
dvakrát tolik, kolik má strom vrcholů s oběma syny, tedy $2\cdot(2^{k-1} -1)$).

Změny preferovaných směrů se ale pro vyšší hodnoty $n$ při výpočtu
průměrného počtu dotyků či průměrného času rozpočítají mezi více operací,
průměr (ať už času nebo počtu dotyků) na operaci tedy bude nižší. Pro $n$
 mezi $3\cdot 2^{k-1}-1$ a $2^{k+1}-1$ naopak přidání každého dalšího listu $P$ způsobí potřebu dvou nových změn preferovaných směrů (v rodiči tohoto listu v $P$) při sekvenčním průchodu tango stromem.

U multisplay stromu to samé zcela neplatí -- změnu preferovaného směru
provádíme i pro vrcholy, které mají jednoho syna, jsou-li cílem hledání
(preferovaný syn pak může být externí vrchol). Přesto ale takové změny
preferovaných směrů způsobí doteky méně vrcholů, než změny preferovaných směrů vrcholů s oběma syny.

Zmenšení rozptylu křivek na obrázcích \ref{obr:touch_s} a \ref{obr:time_s}
kolem $n=1\cdot 10^4$ a $n=5\cdot 10^6$ vysvětlíme snadno -- v relevantních
částech křivky jsme se naším samplováním trefili někam mezi lokální maxima a
minima. Vzhledem k tomu, že jak lokální minima a maxima, tak naše vzorky se
exponenciálně vzdalují, ale jedná se o exponenciály o různých základech, není
toto chování překvapivé.

Nyní se vrátíme zpátky k chování tango stromu při vykonávání náhodné přístupové
posloupnosti.

Pro jednoduchost se budeme zajímat pouze o dva extrémní případy --
případy, kdy $n$ bude buď $2^k-1$, nebo $3\cdot 2^{k-1} - 1$ pro nějaké $k$. V obou
případech platí, že každý vrchol, který má v $P$ oba syny, má také přesně
stejný počet vrcholů ve svém pravém a levém podstromu v $P$. Proto pro každý
přístup (bez ohledu na stav stromu před tímto přístupem) platí, že v každém
vrcholu $P$, kterým hledání projde, ale neskončí v něm (krom vrcholů s jediným
synem), nastane změna preferovaného směru s pravděpodobností $1/2$.

V případě, že se tedy $n$ rovná $2^k-1$ pro nějaké $k$, bude bude střední
hodnota počtu změn preferovaného směru na přístup přesně rovna jedné polovině
průměrné hloubky vrcholu v $P$ (kde kořen má hloubku 0). Pokud se $n$ naopak rovná
$3\cdot2^{k-1}-1$ pro nějaké $k$, bude tato hodnota sice také rovna průměrné
hloubce vrcholu, ale s tím, že listům z poslední hladiny $P$ počítáme hloubku o jedna menší.

Všimneme si, že na rozdíl od sekvenční přístupové posloupnosti je při vykonávání náhodné
posloupnosti střední hodnota počtů změn preferovaných směrů na přístup v $n$
monotónně rostoucí. To je nepřekvapivé -- i pro $n$ mezi $2^k-1$ a $3\cdot
2^{k-1}-1$ stále přidáváme nové vrcholy do spodní vrstvy $P$ a tedy zvyšujeme
pravděpodobnost, že daný dotaz povede hlouběji do stromu $P$, a to i přesto, že
hloubku nejhlubších listů počítáme jako o jedna menší.

\graphfigure{variance_tango_random}{Vliv vzdálenosti od mocniny dvou na počet dotyků vrcholu na přístup -- náhodná přístupová posloupnost.}

Na závěr ještě ukážeme, jak výrazné rozdíly v praxi tento jev na počtu dotyků
způsobí. Na grafu na obrázku \ref{obr:touch_r} je jev velmi nezřetelný, to je ale
částečně tím, že křivka tango stromu na tomto grafu asama o sobě poměrně prudce
roste, v čemž se může leccos ztratit. Proto jsme tento jev alespoň částečně
izolovali. Jednotlivé naměřené hodnoty pro tango strom v grafu na obrázku
\ref{obr:touch_r} označíme jako $h_1, h_2, \dots, h_{50}$. Potom v grafu
\ref{obr:variance_tango_random} zobrazíme hodnoty $$h'_i =
\frac{\frac{h_{i-1}+h{i+1}}2-h_i}2.$$ Jinými slovy, podíváme se, jak daleko je
$h_i$ od aritmetického průměru jeho sousedů. Protože pak ale odečítáme lokální
maximum od průměru dvou lokálních minim nebo naopak, výslednou hodnotu ještě
vydělíme dvěma. Tím dostaneme určitou představu o tom, jak daleko je daný
vzorek od v nějakém smyslu vyhlazené křivky. V grafu vidíme maxima kolem $1/2$,
což zhruba odpovídá očekávání. 

